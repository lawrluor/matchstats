{% extends "base.html" %}

{% block content %}
<div class="container">
  <header class="jumbotron">
    <h1><a href="{{url_for("user", tag=user.tag)}}">{{user.tag}}</a></h1>

    <h3>
      {% if user.trueskill %}
        <!-- Round float value to 4 decimal places -->
        <b>Rating:</b> {{user.trueskill.mu|round(4, 'common')}}
      {% endif %}
    </h3>

    <h3>
      {% if user.region %}
        <b>Region:</b> <a href="{{url_for("region", region=user.region)}}">{{user.region}}</a>
      {% else %}
        <b>Region:</b> None
      {% endif %}
    </h3>

    <h3><b>Main:</b>
      {% if user.main %}
        <a href="{{url_for("character", character=user.main)}}">{{user.main}}</a>
      {% else %}
        Unchosen
      {% endif %}
    </h3>

    <h3>
      <b>Secondaries:</b>
      {% if user.secondaries %}
        {% for i in range(user.secondaries.all()|length) %}
          <!-- If last secondary (last secondary in list), print without comma -->
          {% if i==(user.secondaries.all()|length - 1) %}
            <a href="{{url_for("character", character=secondary)}}">{{user.secondaries.all()[i]}}</a>
          {% else %}
            <a href="{{url_for("character", character=secondary)}}">{{user.secondaries.all()[i]}},</a>
          {% endif %}
        {% endfor %}
      {% else %}
        None
      {% endif %}
    </h3>

    <!-- Route to edit User; Not used in version 1.0 -->
  </header>

  <!-- Table for displaying User's Tournament History -->
  <div class="panel panel-default">
  <div class="panel-heading">
    <h2><b> {{user.tag}}'s Tournament History </b></h2>
  </div>
  <div class="panel-body">
    <table class="table bootstrap-datatable table-condensed table-hover">
      <!-- Empty header (generates navy-colored divider) -->
      <thead>
        <tr>
          <th></th>
          <th></th>
        </tr>
      </thead>

      <!-- user_placements is dictionary of lists with keys tournament_name and list[0]=placement and list[1]=seed -->
      {% for tournament in user_placements %}
      <tr>
        <td class="col-xs-6 col-sm-6 text-right"><b><a href="{{url_for("tournament", tournament_name=tournament)}}">{{tournament}}</a> - </b></td>
        <td class="col-xs-6 col-sm-6 text-left"><b>{{user_placements[tournament][0]}}</b> (seed: {{user_placements[tournament][1]}})</td>
      </tr>
      {% endfor %}
    </table>
  </div>
  </div>

  <!-- Table for displaying User's Sets -->
  <div class="panel panel-default">
  <div class="panel-heading">
    <h2><b>{{user.tag}}'s Set History</b></h2>
  </div>
  <div class="panel-body">
    <table class="table bootstrap-datatable table-hover">
      <b><h4 class="text-center">Total Sets: {{user_sets|length}} | Overall Record: [{{user_wins|length}}-{{user_losses|length}}]</b></h4>
      <thead>
        <tr>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>

      <tbody>
        {% for set in user_sets %}
          {% include 'set.html' %}
        {% endfor %}
      </tbody>
    </table>
  </div>

  </div>
</div>
{% endblock %}
